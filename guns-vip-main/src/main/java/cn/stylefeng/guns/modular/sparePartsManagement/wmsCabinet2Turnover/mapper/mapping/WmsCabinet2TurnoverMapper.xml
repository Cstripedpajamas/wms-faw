<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="cn.stylefeng.guns.modular.sparePartsManagement.wmsCabinet2Turnover.mapper.WmsCabinet2TurnoverMapper">

    <!-- 通用查询映射结果 -->
    <resultMap id="BaseResultMap" type="cn.stylefeng.guns.modular.sparePartsManagement.wmsCabinet2Turnover.entity.WmsCabinet2Turnover">
        <id column="id" property="id" />
        <result column="turnover_number" property="turnoverNumber" />
        <result column="barcode" property="barcode" />
        <result column="storage_status" property="storageStatus" />
        <result column="loca_row" property="locaRow" />
        <result column="loca_col" property="locaCol" />
        <result column="loca_layer" property="locaLayer" />
        <result column="turnover_state" property="turnoverState" />
        <result column="data_state" property="dataState" />
        <result column="create_time" property="createTime" />
    </resultMap>

    <!-- 通用查询结果列 -->
    <sql id="Base_Column_List">
        id AS "id", turnover_number AS "turnoverNumber", barcode AS "barcode", storage_status AS "storageStatus", loca_row AS "locaRow", loca_col AS "locaCol", loca_layer AS "locaLayer", turnover_state AS "turnoverState", data_state AS "dataState", create_time AS "createTime"
    </sql>


    <select id="customList" resultType="cn.stylefeng.guns.modular.sparePartsManagement.wmsCabinet2Turnover.model.result.WmsCabinet2TurnoverResult" parameterType="cn.stylefeng.guns.modular.sparePartsManagement.wmsCabinet2Turnover.model.params.WmsCabinet2TurnoverParam">
        select
        <include refid="Base_Column_List"/>
        from wms_cabinet2_turnover where 1 = 1
            <if test="paramCondition.turnoverNumber != null and paramCondition.turnoverNumber != ''">
                and turnover_number like CONCAT('%',#{paramCondition.turnoverNumber},'%')
            </if>
            <if test="paramCondition.barcode != null and paramCondition.barcode != ''">
                and barcode like CONCAT('%',#{paramCondition.barcode},'%')
            </if>
    </select>

    <select id="customMapList" resultType="map" parameterType="cn.stylefeng.guns.modular.sparePartsManagement.wmsCabinet2Turnover.model.params.WmsCabinet2TurnoverParam">
        select
        <include refid="Base_Column_List"/>
        from wms_cabinet2_turnover where 1 = 1
            <if test="paramCondition.turnoverNumber != null and paramCondition.turnoverNumber != ''">
                and turnover_number like CONCAT('%',#{paramCondition.turnoverNumber},'%')
            </if>
            <if test="paramCondition.barcode != null and paramCondition.barcode != ''">
                and barcode like CONCAT('%',#{paramCondition.barcode},'%')
            </if>
    </select>

    <select id="customPageList" resultType="cn.stylefeng.guns.modular.sparePartsManagement.wmsCabinet2Turnover.model.result.WmsCabinet2TurnoverResult" parameterType="cn.stylefeng.guns.modular.sparePartsManagement.wmsCabinet2Turnover.model.params.WmsCabinet2TurnoverParam">
        select
        <include refid="Base_Column_List"/>
        from wms_cabinet2_turnover where 1 = 1
            <if test="paramCondition.turnoverNumber != null and paramCondition.turnoverNumber != ''">
                and turnover_number like CONCAT('%',#{paramCondition.turnoverNumber},'%')
            </if>
            <if test="paramCondition.barcode != null and paramCondition.barcode != ''">
                and barcode like CONCAT('%',#{paramCondition.barcode},'%')
            </if>
    </select>

    <select id="customPageMapList" resultType="map" parameterType="cn.stylefeng.guns.modular.sparePartsManagement.wmsCabinet2Turnover.model.params.WmsCabinet2TurnoverParam">
        select
        <include refid="Base_Column_List"/>
        from wms_cabinet2_turnover where 1 = 1
            <if test="paramCondition.turnoverNumber != null and paramCondition.turnoverNumber != ''">
                and turnover_number like CONCAT('%',#{paramCondition.turnoverNumber},'%')
            </if>
            <if test="paramCondition.barcode != null and paramCondition.barcode != ''">
                and barcode like CONCAT('%',#{paramCondition.barcode},'%')
            </if>
    </select>

    <update id="updateState" parameterType="string">
        update wms_cabinet2_turnover
        set storage_status = #{state},
        loca_row = "",
        loca_col = "",
        loca_layer = ""
        where id = #{turnoverID}
    </update>

    <update id="updateStockLocal" parameterType="string">
        update wms_cabinet2_turnover
        set storage_status = #{state},
         loca_row = #{row},
        loca_col = #{col},
        loca_layer = #{layer}
        where id = #{turnoverID}
    </update>
    <update id="updateTurnState" parameterType="string">
        update wms_cabinet2_turnover
        set turnover_state = #{state}
        where id = #{turnoverID}
    </update>

    <select id="findTurnoverNumber" parameterType="string" resultType="string">
        select turnover_number from wms_cabinet2_turnover where id = #{turnoverID}
    </select>

    <select id="findIdByTurnoverNumber" parameterType="string" resultType="string">
        select id from  wms_cabinet2_turnover where  turnover_number = #{turnoverNumber}
    </select>
</mapper>
